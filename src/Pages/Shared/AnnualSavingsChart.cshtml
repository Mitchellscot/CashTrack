@model CashTrack.Pages.Shared.AnnualSavingsChart
@{
}
<script>
    const @Model.VariableName = document.getElementById(@Json.Serialize(@Model.ElementId)).getContext('2d');
    const @Model.ElementId = new Chart(@Model.VariableName, {
        type: 'line',
        data: {
            labels: @Html.Raw(@Model.Labels),
            datasets:[
            {
                label: 'Savings',
                data: @Model.Dataset,
                color: 'rgba(0, 0, 0, 0)',
                backgroundColor: colorize(),
                borderColor: colorize(),
                borderWidth: 5,
                fill: false,
                cubicInterpolationMode: 'monotone',
                tension: 1,
                segment:{
                    borderColor: colorizeSegment(),
                    backgroundColor: colorizeSegment()
                }
            },
            {
                label: 'Planned Savings',
                data: @Model.BudgetedSavingsDataset,
                color: 'rgba(0, 0, 0, 0)',
                backgroundColor: colorizeBudgeted(),
                borderColor: colorizeBudgeted(),
                borderWidth: 5,
                fill: false,
                cubicInterpolationMode: 'monotone',
                tension: 1,
                segment:{
                    borderColor: colorizeBudgetedSegment(),
                    backgroundColor: colorizeBudgetedSegment()
                }
            },
            ]
        },
        options: {
            responsive: true,
            plugins:{
                title: {
                    display: false
                },
                legend: {
                    display: false
                },
            }
        },
    });
        function colorizeSegment() {
        return (ctx) => {
            const i = ctx.p0DataIndex;
            const v = ctx.p0.raw;
            if(v < 0 && i)
                return @Html.Raw(Model.NegativeSavingsColor)
            else if(v > 0)
                return @Html.Raw(Model.SavingsColor)
            else return @Html.Raw(Model.BudgetedSavingsColor)
        }
    };
        function colorize() {
        return (ctx) => {
            const i = ctx.index;
            const v = ctx.raw;
            if(v < 0 && i)
                return @Html.Raw(Model.NegativeSavingsColor)
            else if(v > 0)
                return @Html.Raw(Model.SavingsColor)
            else return @Html.Raw(Model.BudgetedSavingsColor)
        }
    };
    function colorizeBudgeted() {
        return (ctx) => {
            const i = ctx.index;
            const v = ctx.raw;
            if(v < 0)
                return @Html.Raw(Model.NegativeSavingsColor)
            else if(v > 0)
                return @Html.Raw(Model.BudgetedSavingsColor)
            else return @Html.Raw(Model.BudgetedSavingsColor)
        }
    };
    function colorizeBudgetedSegment() {
        return (ctx) => {
            const i = ctx.p0DataIndex;
            const v = ctx.p0.raw;
            if(v < 0 && i)
                return @Html.Raw(Model.NegativeSavingsColor)
            else if(v > 0)
                return @Html.Raw(Model.BudgetedSavingsColor)
            else return @Html.Raw(Model.BudgetedSavingsColor)
        }
    };

</script>