@page
@using CashTrack.Models.ImportCsvModels
@using CashTrack.Models.ImportRuleModels;
@using CashTrack.Pages.Shared;
@model CashTrack.Pages.Settings.Index
@{
    ViewData["Title"] = "Settings";
    Layout = "_Layout";
}
<div class="container mt-3">
    @await Html.PartialAsync("_MessagePartial",
    new _MessagePartial() { Message = Model.InfoMessage, MessageType = MessageType.Info, Show = Model.InfoMessage != null })
    @await Html.PartialAsync("_MessagePartial",
    new _MessagePartial() { Message = Model.SuccessMessage, MessageType = MessageType.Success, Show = Model.SuccessMessage != null })
    @await Html.PartialAsync("_MessagePartial",
    new _MessagePartial() {MessageType = MessageType.Danger, Show = !ViewData.ModelState.IsValid })
    <h1>Settings</h1>
    <div class="row my-3 border rounded border-2">
        <form asp-handler="ChangePassword" class="col px-5 pt-2 pb-5 d-flex justify-content-around align-content-center" method="post">
            <div class="form-group col-4">
                <label asp-for="ChangePassword.OldPassword" class="form-label mt-4">Old Password</label>
                <input asp-for="ChangePassword.OldPassword" type="password" class="form-control" id="oldPasswordInput" placeholder="* * * * * *">
            </div>
            <div class="form-group col-4">
                <label asp-for="ChangePassword.NewPassword" class="form-label mt-4">New Password</label>
                <input asp-for="ChangePassword.NewPassword" type="password" class="form-control" id="newPasswordInput" placeholder="* * * * * *">
            </div>
            <button class="btn btn-primary btn-height align-self-end" type="submit">Change Passwords</button>
        </form>
@*        <form method="post" asp-page-handler="ChangeTax">
            <div class="form-group col px-5 pb-5 col-3">
                <label asp-for="Tax" class="form-label mt-4">Change Default Tax Rate</label>
                <input asp-for="Tax" type="text" class="form-control" id="changeTaxInput">
            </div>
        </form>*@
    </div>

    <h2>Export</h2>
    <form class="row my-3 border rounded border-2" method="post">
        <div class="col-5 p-5 d-flex justify-content-start">
            <div class="input-group">
                <div class="input-group-prepend d-none d-sm-block">
                    <div class="input-group-text">Data</div>
                </div>
                <select data-width="100%" asp-items="Model.ExportOptions" class="form-select text-center" id="exportOptions" asp-for="ExportOption">
                </select>
            </div>
        </div>
        <div class="col-4 d-flex justify-content-center">
            <div class="form-check me-3 d-flex align-items-center">
                <input class="form-check-input me-2" type="radio" asp-for="ExportAsReadable" value="false">
                <label asp-for="ExportAsReadable" class="form-check-label">Raw Data</label>
            </div>
            <div class="form-check d-flex align-items-center">
                <input class="form-check-input me-2" type="radio" asp-for="ExportAsReadable" value="true">
                <label asp-for="ExportAsReadable" class="form-check-label">Readable Data</label>
            </div>
        </div>
        <div class="col-3 d-flex justify-content-center">
            <button class="btn btn-primary btn height align-self-center" type="submit" asp-page-handler="Export">
                Export Data
            </button>
        </div>
    </form>

    <h2>Import</h2>
    <div class="row my-3 border rounded border-2">
        <div class="p-5 d-flex justify-content-around">
            <a asp-page="/Import/Rules" class="btn btn-secondary">Import Rules</a>
            <button class="btn btn-primary float-end" id="addImportRuleButton" data-bs-toggle="modal" data-bs-target="#addImportRuleModal">Add Import Rule</button>
            <button class="btn btn-primary" type="button" id="importButton" data-bs-toggle="modal" data-bs-target="#customCsvHeader">
                Define Custom CSV Headers
            </button>
            <button class="btn btn-primary" type="button" id="importButton" data-bs-toggle="modal" data-bs-target="#importCsvModal">
                Import From CSV
            </button>
        </div>
    </div>
</div>
<div class="modal fade" id="importCsvModal">
    @await Html.PartialAsync("_ImportTransactionsModal", new ImportModel() { ReturnUrl = "~/Import/Expenses" })
</div>
<div class="modal fade" id="addImportRuleModal">
    @await Html.PartialAsync("_AddEditImportRuleModal", new AddEditImportRuleModal() { Returnurl = "~/Import/Rules", IsEdit = false })
</div>
@section Scripts {
    <script src="~/js/settings.js"></script>
    <script src="~/js/rules.js"></script>
}